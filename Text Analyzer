import string
import pandas as pd

class TextAnalyzer:
    def __init__(self, text):
        """
        Initializes a TextAnalyzer object with the provided text.
        
        Args:
            text (str): Text to analyze.
        """
        try:
            # Remove punctuation, convert to lowercase, and split into words
            if not isinstance(text, str):
                raise TypeError("Text must be a string!")
            self.clean_txt = text.translate(str.maketrans('', '', string.punctuation)).lower().split()
            self.original_txt = text
        except (AttributeError, TypeError) as e:
            print(f"Error: {e}")
            self.clean_txt = []
            self.original_txt = ""

    def get_word_count(self):
        """
        Returns the number of words in the text.
        
        Returns:
            int: Number of words.
        """
        return len(self.clean_txt)

    def get_frequent_words(self, min_count=1):
        """
        Returns a DataFrame with word frequency.
        
        Args:
            min_count (int): Minimum number of word occurrences.
        
        Returns:
            pandas.DataFrame: DataFrame with columns 'word' and 'frequency'.
        """
        try:
            freq = {}
            for word in self.clean_txt:
                freq[word] = freq.get(word, 0) + 1
            freq_dict = {word: count for word, count in freq.items() if count >= min_count}
            return pd.DataFrame(list(freq_dict.items()), columns=['word', 'frequency'])
        except Exception as e:
            print(f"Error during frequency analysis: {e}")
            return pd.DataFrame()

# Test
if __name__ == "__main__":
    try:
        text = "This is a test! This is an example."  
        analyzer = TextAnalyzer(text)
        print("Word count:", analyzer.get_word_count())
        print("\nFrequent words:\n", analyzer.get_frequent_words())
    except Exception as e:
        print(f"Error: {e}")
